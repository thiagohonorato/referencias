function manageActiveControl(){return null!=activeControl&&activeControl!=this?(activeControl.onClearButton.bindAsEventListener(activeControl)(),activeControl.removeAllRefinements(),activeControl=this):null==activeControl&&(activeControl=this),!0}function applyOpenAccessOrSubscribedContentFilter(a,b){for(var c=a+document.getElementById("oqs").value,d=0;d<b.size();d++){var e=b[d],f=document.getElementById(e).checked;if(0==f){var g=e+"%3Dtrue";c=c.replace(g,"")}else{var g=e+"%3Dfalse",h="&"+e+"=true";c=c.replace(g,"")+h}}c+="&pageNumber=1&resultAction=REFINE&history=no",window.location=c}function applyRefinements(a,b,c){{var d,e=b+document.getElementById("oqs").value,f=$(a).childElements();new Array}for(d=0;d<f.length;d++)e+="&"+c+"="+f[d].id;e+="&pageNumber=1&resultAction=REFINE",window.location=e}function applyDateRange(a,b,c){var d=a+document.getElementById("oqs").value,e=document.getElementById("text_startyear").value,f=e;document.getElementById("radio_range").checked&&(f=document.getElementById("text_endyear").value),d+=b+"="+e+"_"+f+"_"+c,d+="&pageNumber=1&resultAction=REFINE",window.location=d}function addDateSlider(a,b){var c=[$("start-date-slider"),$("end-date-slider")];DateSliderValues=[a,b],DateSlider=new IEEEDateSlider(c,"Date-slider",{range:$R(DateValues.first(),DateValues.last()),values:DateValues,restricted:!0,sliderValue:[DateValues.first(),DateValues.last()],handleImage:["start-date-slider-image","end-date-slider-image"],alignX:-5,updateVisible:!1,onSlide:function(a,b){if(currentStart=$("text_startyear"),currentEnd=$("text_endyear"),currentStart.value!=a[0]||currentEnd.value!=a[1]){if(!manageActiveControl.bind(b)(function(){this.setValues($("text_startyear").value,0),this.setVlaues($("text_endyear").value,1)}))return!1;currentStart.value=a[0],currentEnd.value=a[1];var c=b.track.up("table").next(".update-button");b.options.updateVisible||(b.options.updateVisible=!0,new Effect.BlindDown(c,{duration:.25}))}},selectionType:"range"})}function filterQueryElement(a,b){var c=3;arguments.length>1&&(c=b);var d=a.value;if(d=j$.trim(d),!d.match(/\w/))return alert("Please enter one or more keywords"),!1;d=getFilteredTerms(d);var e=d.match(/\*/g);if(null!=e&&e.length>5)return alert("Please limit the number of wildcarded words to 5"),!1;parts=d.split(/[^*_a-z_A-Z_0-9]/);for(var f=0;f<parts.length;f++)if(parts[f].indexOf("*")>-1){var g=parts[f].match(/\w/g);if(null==g||g.length<c)return alert("Please provide at least "+c+" valid characters in wildcarded word ("+parts[f]+")"),!1}return d=stopCrossSiteScripting(d),a.value=d,!0}function filterQuery(a){var b=document.getElementById(a);return filterQueryElement(b)}var activeControl=null,IEEEDateSlider=Class.create(Control.Slider,{onClearButton:Prototype.emptyFunction,removeAllRefinements:function(){this.setValue(this.options.values.first(),0),this.setValue(this.options.values.last(),1),$("text_startyear").value=this.values[0],$("text_endyear").value=this.values[1],this.options.updateVisible=!1,new Effect.BlindUp(this.track.up("table").next(".update-button"),{duration:.25})},handleSelectionTypeChoice:function(a){return a.value!=this.options.selectionType&&("single"==a.value?(new Effect.BlindUp("end-year-input",{duration:.25}),$("start-year-input").firstDescendant().update("Year:"),$("end-date-slider").hide(),this.setValue(this.options.values[this.options.values.length-1],1),this.options.selectionType=a.value):"range"==a.value&&($("start-year-input").firstDescendant().update("From:"),$("end-date-slider").show(),new Effect.BlindDown("end-year-input",{duration:.25}),this.options.selectionType=a.value),this.options.updateVisible||(this.options.updateVisible=!0,new Effect.BlindDown(Element.down(Element.up(a,"div"),".update-button"),{duration:.25}))),!0},selectClosestValue:function(a,b){manageActiveControl.bind(this)();for(var c=null,d=null,e=0;e<this.options.values.length&&!(0==b&&this.options.values[e]>a.value);e++)if(!(1==b&&this.options.values[e]<a.value)){var f=Math.abs(a.value-this.options.values[e]);(null==c||c>f)&&(c=f,d=this.options.values[e])}return 0==b&&a.value<this.options.values.first()?d=this.options.values.first():1==b&&a.value>this.options.values.last()&&(d=this.options.values.last()),null!=d&&(b-1>=0&&d<this.values[b-1]&&(d=this.values[b-1]),b+1<this.values.length&&d>this.values[b+1]&&(d=this.values[b+1]),this.setValue(d,b),a.value=d),this.options.updateVisible||(this.options.updateVisible=!0,new Effect.BlindDown(Element.down(Element.up(a,"div",1),".update-button"),{duration:.25})),!1}}),IEEERefinementAutocompleter=Class.create(Ajax.Autocompleter,{addRefinement:function(a){manageActiveControl.bind(this)(),this.options.selectedItems.any(function(b){return b==a.id})||this.options.selectedItems.push(a.id);var b=this.options.selectedList,c=b.previous("h5"),d=b.next("."+this.options.updateButtonClass),e=this.options.backgroundColor,f=(this.options.highlightColor,function(){b.visible()||b.show(),a.down("."+this.options.refinementClass).style.backgroundColor=e;var f=[];f.push(new Effect.BlindDown(a)),c.visible()||f.push(new Effect.BlindDown(c)),d.visible()||f.push(new Effect.BlindDown(d)),b.appendChild(a),a.down("."+this.options.selectorClass).checked=!0,new Effect.Parallel(f,{duration:.25})});new Effect.BlindUp(a,{duration:.25,afterFinish:f.bind(this)})},removeRefinement:function(a){for(var b=null,c=(this.options.selectedItems.length,0);c<this.options.selectedItems.length;c++)b=this.options.selectedItems.shift(),b!=a.id&&this.options.selectedItems.push(b);var d=this.options.selectedList.previous("h5"),e=this.options.selectedList.next("."+this.options.updateButtonClass),f=[];1==this.options.selectedList.childElements().length&&(f=[new Effect.BlindUp(this.options.selectedList),new Effect.BlindUp(d),new Effect.BlindUp(e)]),f.push(new Effect.BlindUp(a));var g=this.refreshRefinementListContents.bind(this),h=this.cleanSelectedListContents.bind(this);new Effect.Parallel(f,{duration:.25,afterFinish:function(){g(),h()}})},removeAllRefinements:function(){for(var a=this.options.selectedItems.length,b=0;a>b;b++)this.options.selectedItems.shift();for(var c=this.options.selectedList.previous("h5"),d=this.options.selectedList.next("."+this.options.updateButtonClass),e=[new Effect.BlindUp(this.options.selectedList),new Effect.BlindUp(c),new Effect.BlindUp(d)],f=this.options.selectedList.childElements(),b=0;b<f.length;b++)e.push(new Effect.BlindUp(f[b]));var g=this.refreshRefinementListContents.bind(this),h=this.cleanSelectedListContents.bind(this);new Effect.Parallel(e,{duration:.25,afterFinish:function(){g(),h()}})},checkboxHandler:function(a){var b=Event.element(a),c=b.up("li");b.checked?this.addRefinement(c):this.removeRefinement(c)},initializeItem:function(a){a.show(),checkbox=a.down("."+this.options.selectorClass),checkbox.stopObserving("click"),checkbox.observe("click",this.checkboxHandler.bindAsEventListener(this)),checkbox.checked=!1},replaceRefinementListContents:function(a){for(;!this.options.refinementList.empty();)this.options.refinementList.down().remove();for(var b=null,c=0;c<a.length;c++)b=a[c],b.down("."+this.options.refinementClass).style.backgroundColor=this.options.backgroundColor,this.isItemSelected(b)||(this.initializeItem(b),this.options.refinementList.appendChild(b));this.listContents=a},refreshRefinementListContents:function(){for(var a=null,b=this.options.refinementList.select("li"),c=null,d=0,e=0;e<this.listContents.length;e++)a=this.listContents[e],this.isItemSelected(a)||(this.initializeItem(a),d<b.length?(c=b[d],a.id!=c.id?(Element.insert(c,{before:a}),this.revealRefinementItem(a)):d++):(Element.insert(this.options.refinementList,{bottom:a}),this.revealRefinementItem(a)))},cleanSelectedListContents:function(){for(var a=this.options.selectedList.select("li"),b=0;b<a.length;b++)a[b].visible()||a[b].remove()},revealRefinementItem:function(a){var b=this.options.highlightColor,c=function(){a.down("."+this.options.refinementClass).style.backgroundColor=b};new Effect.BlindDown(a,{duration:.25,afterFinish:c.bind(this)}),a.down("."+this.options.refinementClass).style.backgroundColor=b},isItemSelected:function(a){return this.options.selectedItems.any(function(b){return b==a.id})},onComplete:function(a){this.updateChoices(a.responseText),this.replaceRefinementListContents(this.update.select("li")),this.getToken().length>=this.options.minChars&&this.element.next("."+this.options.clearButtonClass).show()},onKeyUp:function(){this.getToken().length>=this.options.minChars?this.element.next("."+this.options.clearButtonClass).show():(this.element.next("."+this.options.clearButtonClass).hide(),this.replaceRefinementListContents(this.options.defaultItems))},onClearButton:function(){this.element.value="",this.element.next("."+this.options.clearButtonClass).hide(),this.replaceRefinementListContents(this.options.defaultItems)},onHover:Prototype.emptyFunction,onClick:Prototype.emptyFunction,onBlur:Prototype.emptyFunction,updateElement:function(){}}),selectionType,DateValues,DateSlider,DateSliderValues;