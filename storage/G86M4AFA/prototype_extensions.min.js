Object.extend(String.prototype,{getHash:function(){var idx=this.indexOf("#");return(idx>=0)?this.substring(idx+1):null},toSlug:function(){return this.gsub(/['"]/,"").gsub(/[^A-Za-z0-9]/," ").strip().gsub(/ +/,"-").toLowerCase()}});Object.extend(Prototype.Browser,{IE6:(function(){return(/msie 6/i.test(navigator.userAgent))&&!(/opera/i.test(navigator.userAgent))&&(/win/i.test(navigator.userAgent))})(),WebkitOld:(function(){var regex=navigator.userAgent.match(/AppleWebKit\/(\d+)/);return(regex&&regex.length==2)?(parseInt(regex[1])<=419):false})()});function fixWebKitInheritanceBug(obj){if(Prototype.Browser.WebkitOld){obj.prototype.constructor=obj}}function $$S(){var args=$A(arguments),scope=args.shift();return Selector.findChildElements(scope,args)}function $FE(form_name,element_name){if((typeof (form_name)!="string")||typeof (element_name)!="string"){return }var f=document.forms[form_name]||$$("FORM#"+form_name)[0];var elements=f.elements[element_name];if(!f||!elements){return null}else{return elements}}document.observe("dom:loaded",function(){function fixDisabledOptions(){$A(this.options).each(function(opt){if($(opt).disabled){opt.selected=false}})}$$("SELECT").each(function(sel){Event.observe(sel,"change",fixDisabledOptions.bind(sel))})});if(Prototype.Browser.IE||Prototype.Browser.WebKit){document.observe("dom:loaded",function(){$$("LABEL IMG").each(function(image){var el=$(image.parentNode.getAttribute("for")&& image.parentNode.attributes["for"].nodeValue);if(el){image.observe("click",function(){el.focus()})}})})}function Site(globals){this.GLOBALS=Object.extend({active_class:"Active",expanded_class:"Expanded",disabled_class:"Disabled",deleted_class:"Deleted",selected_class:"Selected",hover_class:"Hover",link_class:"Link",dhtml_link_class:"LinkDHTML",img_path:"/images/",ajax_update_delay:100},globals||{});this.DEBUG=function(){var qs=window.location.search.toQueryParams();return(Object.keys(qs).indexOf("DEBUG")>-1)||false}();this.debug=function(msg){if(!this.DEBUG){return }if(msg instanceof Array){msg=msg.join("\n")}try{console.log(msg)}catch(e){if(!this.debug_win){this.debug_win=window.open("","","");this.debug_win.document.open()}msg=msg.replace(/</g,"&lt;");msg=msg.replace(/>/g,"&gt;");try{this.debug_win.document.write("")}catch(e){this.debug_win=window.open("","","");this.debug_win.document.open()}this.debug_win.document.write("<pre style='font-size: 80%; margin: .5em 0 2em 0;'>"+msg+"</pre>")}};this.addFeature=function(feature_name,config){if(this.Features[feature_name]){return }delete config.widget_instances;delete config.storeWidgetInstance;delete config.removeWidgetInstance;delete config._setupElements;this.Features[feature_name]=Object.extend({widget_instances:{},storeWidgetInstance:function(id,widget,overwrite){if(typeof (this.widget_instances[id])==="undefined"){this.widget_instances[id]=widget;return true}else{if(overwrite===true){this.widget_instances[id]=widget;return true}else{return false}}},removeWidgetInstance:function(id){if(typeof (this.widget_instances[id])!=="undefined"){delete this.widget_instances[id];return true}else{return false}},initialize:Prototype.emptyFunction,setupElements:Prototype.emptyFunction,_setupElements:function(root_node){root_node=$(root_node)||document;this.setupElements(root_node)}},config||{});this.Features[feature_name].initialize();if(!this["DOM_LOADED"]){document.observe("dom:loaded",this.Features[feature_name]._setupElements.bind(this.Features[feature_name],document))}else{this.Features[feature_name]._setupElements()}};this.Features={};this.DOM_LOADED=false;document.observe("dom:loaded",function(){this.DOM_LOADED=true}.bind(this))}var PageWidget=Class.create({node:null,initialize:function(id,options){this.node=$(id);this.setOptions(options)},setOptions:function(config){this.CONFIG=Object.extend(Object.clone(this.constructor.CONFIG),config||{})}});PageWidget.CONFIG={};fixWebKitInheritanceBug(PageWidget);