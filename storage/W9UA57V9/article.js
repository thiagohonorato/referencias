function populateRightsLink(){var a=document.getElementById("rightsLinkPath").value;$j(".tools-rights a").click(function(b){b.preventDefault(),window.open(a,"Rightslink","location=no,toolbar=no,directories=no,status=no, menubar=no,scrollbars=yes,resizable=yes,width=650,height=750")})}function populateRelatedArticles(a){if($j(a)){$j("#related-articles div.section").remove();var b=[];b.push("<div class='section'>"),$j(a).each(function(){b.push('<h4><a href="'+this.mdUrl+'">'+this.title+"</a></h4></div>"),b.push("<div class='section separator'>")}),b.pop(),$j("#related-articles").append(b.join(""))}}function startUpFunction(){function a(a,b){var c=$j("#LayoutWrapper");c.find("div.fig-win").remove();var d=$j('<div class="fig-win" />'),e=$j('<span class="button"><span>X CLOSE</span></span>');e.click(function(){$j(this).parent(".fig-win").remove()}),d.append(e);var f=$j('<img src="'+a+'" alt="'+b+'" />');d.append(f),c.prepend(d),$j(".fig-win").bind("click",function(){$j(this).remove()})}function b(a,b,c){var d=a.find("div.header h2").text(),e=$j('<li id="glance-'+b+'"><span>'+d+"</span></li>");c&&e.addClass("empty"),t.append(e)}function c(a,b){var c=a.find("div.content").clone(),d=$j('<div class="panel"></div>').addClass("glance-"+b);c.appendTo(d),d.hide().appendTo(s)}function d(a,b){controls_el=$j(null!==b?'<div class="panel-nav-bottom"><div class="all"><a href="'+b+'">View All</a></div></div>':'<div class="panel-nav-bottom"><div class="all empty"></div></div>'),controls_el.appendTo(a.find("div.content"))}function e(a,b,c){var d=a.find("div").filter(function(){return $j(this).hasClass(b)}).removeAttr("id"),e=d.length;if(e>c){var f=a.find("div.panel-nav-bottom"),g=$j('<div class="slide-nav" />'),h=Math.ceil(e/c);for(i=0,j=c,k=1;h>=k;)d.slice(i,j).wrapAll('<div class="slide s_'+k+'"></div>'),d.slice(i,i+1).addClass("first-item"),$j('<span class="btn">s_'+k+"</span>").click(function(){var a=$j(this);a.addClass("active").siblings("span.btn").removeClass("active"),a.parents("div.content").find("div.slide").hide().filter(function(){return $j(this).hasClass(a.text())}).show()}).appendTo(g),i+=c,j+=c,k++;var l=a.find("div.slide");g.children("span.btn:first-child").addClass("active");var m=$j('<span class="prev off">prev</span>').click(function(){l.first().is(":hidden")&&(l.filter(function(){return $j(this).is(":visible")}).hide().prev().show(),$j(this).siblings("span.btn").filter(function(){return $j(this).hasClass("active")}).removeClass("active").prev().addClass("active"),l.first().is(":visible")&&$j(this).addClass("off"),l.last().is(":hidden")&&$j(this).siblings(".next").removeClass("off"))}),n=$j('<span class="next active">next</span>').click(function(){if(l.last().is(":hidden")){l.filter(function(){return $j(this).is(":visible")}).hide().next().show();var a=$j(this).siblings("span.btn");a.filter(function(){return $j(this).hasClass("active")}).removeClass("active").next().addClass("active"),l.first().is(":hidden")&&$j(this).siblings(".prev").removeClass("off"),l.last().is(":visible")&&$j(this).addClass("off")}});m.prependTo(g),n.appendTo(g),g.prependTo(f)}else d.removeAttr("id").first().addClass("first-item")}function f(a,b){var c=a.find("span.link","div.footer"),d=a.find("div.snippet"),e=c.filter(function(){return $j(this).hasClass(b)}),f=d.filter(function(){return $j(this).hasClass(b)});f.is(":hidden")?(d.hide(),f.show(),c.removeClass("open_lnk"),e.addClass("open_lnk")):(f.hide(),e.removeClass("open_lnk"))}function g(){calc_h=$j("#FooterWrapper").innerHeight()+ob+75,win_h=$j(window).height(),win_h>calc_h&&(margin=win_h-calc_h,nb.css({"margin-bottom":margin}))}function h(){if(!C&&!D&&(w.length||y.length)){var a,b,c=$j(window).scrollTop();if(w.length?(a=w.first().offset().top,b="5px"):(a=y.first().offset().top,b="65px"),c+50>=a){var d=$j("#Body"),e=d.offset().top+d.outerHeight()-95,f=c+u.outerHeight()+35;u.css(f>e?{position:"absolute",top:"auto",bottom:b}:{position:"fixed",top:"50px",bottom:"auto"}),sb&&l()}else u.css({position:"absolute",top:"auto",bottom:"auto"}),qb.removeClass("selected")}}function l(){var a=$j(window).scrollTop();a>=Math.round(v.offset().top)&&(qb.removeClass("selected"),rb.addClass("selected")),a>=Math.round(z.offset().top)&&A.each(function(){var b=$j(this);if(a>=Math.round(b.offset().top)){var c=b.attr("id");pb.find("a").each(function(){var a=$j(this);return a.attr("href")=="#"+c?(qb.removeClass("selected"),a.parent("li").addClass("selected"),!1):void 0})}})}function m(){window.hidePopupTimeout&&clearTimeout(window.hidePopupTimeout)}function n(){window.hidePopupTimeout=setTimeout(o,750)}function o(){xb.removeClass("flip").hide(),wb.removeClass("popup_active")}function p(a,b){a.hover(function(){$j(this).addClass(b)},function(){$j(this).removeClass(b)})}var q="glance",r="hires",s=$j("#at-glance"),t=s.find("ul.tab-menu"),u=$j("#article-nav"),v=$j("#article"),w=v.find("div.section"),x=$j("#FiguresPage"),y=x.find("div.section"),z=$j("#article-data"),A=z.find("div.section:visible"),B=$j("#footnotes");if($j.browser.msie&&"6.0"==$j.browser.version)var C=!0;if("iPad"==navigator.platform)var D=!0;var E=!0;if($j.find(".no-glance").length>0&&(E=!1),E){var F=$j("#authors");if(F.find("div.no-content").length)b(F,"authors",!0);else{b(F,"authors"),c(F,"authors");var G=s.find("div.glance-authors");d(G,"#"+F.attr("id")),G.find("div.footer").remove(),G.find("div.author").each(function(){var a=$j(this);$j(this).find("div.bio > p").truncate({words:65}).eq(0).nextAll().remove(),a.append('<div class="more"><a href="#'+a.attr("id")+'">More About this Author</a></div>').click(function(){$j("#authors .content").show()})}),e(G,"author",3)}var H=v.find("div.figure"),I=H.not("div.table");if(t.append('<li id="glance-figures"><span>Figures</span></li>'),H.length){var J=H.find("div.img-wrap a");C||D||J.append('<div class="zoom" title="View Larger Image" />').click(function(){return this_lnk=$j(this).attr("href"),this_alt=$j(this).find("img").attr("alt"),a(this_lnk,this_alt),!1});var K=$j('<div class="panel glance-figures" />'),L=null,M=!1;u.find("a").each(function(){return this_lnk=$j(this),"figures"==this_lnk.text().toLowerCase()?(L=this_lnk.attr("href"),M=!0,!1):void 0})}if(I.length){I.each(function(){this_clone=$j(this).clone(),this_clone.find("p.links").remove(),this_clone.find("a[id]").remove(),this_img_wrap=this_clone.find("div.img-wrap"),this_fig_img=this_img_wrap.find("img"),this_img_src=this_fig_img.attr("src");var b=this_fig_img.attr("alt");img_path=this_img_src.substring(0,this_img_src.lastIndexOf("-")+1),file_type=this_img_src.substring(this_img_src.lastIndexOf(".")),glance_src=img_path+q+file_type;var c=this_img_wrap.find("a");c.find("img").remove(),c.prepend('<img src="'+glance_src+'" alt="'+b+'" />'),C||D||c.click(function(){return this_lnk=$j(this).attr("href"),a(this_lnk,b),!1}),this_figcaption=this_clone.find("div.figcaption"),this_figcaption.wrap('<div class="copy" />'),this_clone.find("b.title").clone().addClass("fig-title").insertAfter(this_img_wrap),new_fig_tools=$j('<ul class="tools" />'),this_fig_id=this_clone.attr("id"),new_fig_tools.append('<li><a href="#'+this_fig_id+'">View in Context</a></li>'),hires_src=img_path+r+file_type,new_fig_tools.append('<li><a href="'+hires_src+'" target="_blank">View Hi-Res Image</a></li>'),M&&new_fig_tools.append('<li><a href="'+L+'">View All Figures</a></li>'),new_fig_tools.insertAfter(this_figcaption),this_clone.appendTo(K)}),K.wrapInner('<div class="content" />').hide().appendTo(s);var N=s.find("div.glance-figures");d(N,L),e(N,"figure",3);var O=N.find("div.slide");O.length?O.each(function(){$j(this).find("div.figure").each(function(a){$j(this).addClass("pos_"+(a+1))})}):N.find("div.figure").each(function(a){$j(this).addClass("pos_"+(a+1))})}else $j("#glance-figures").addClass("empty");var P=$j("#media");if(P.css({display:"none"}),P.find("div.no-content").length)b(P,"media",!0);else{b(P,"media"),c(P,"media");var Q=s.find("div.glance-media"),R=Q.find("div.video");R.find("div.body").after('<span class="button play"><a href="#" class="playVideo">Watch</a></span>'),R.prepend('<a href="#" class="playVideo button-empty"></a>'),Q.find("div.item:not(.video)").each(function(){var a=$j(this),b=a.find(".button a").attr("href");a.prepend('<a href="'+b+'" class="button-empty"></a>')});var Q=s.find("div.glance-media");media_href=null,u.find("a").each(function(){return this_lnk=$j(this),"media"==this_lnk.text().toLowerCase()?(media_href=this_lnk.attr("href"),!1):void 0}),d(Q,media_href),e(Q,"item",3)}var S=$j("#references");if(S.find("div.no-content").length)b(S,"references",!0);else{b(S,"references"),c(S,"references");var T=s.find("div.glance-references");T.find("div.content").wrapInner('<div id="ref_wrap" />');var U=$j("#ref_wrap");d(T,"#"+S.attr("id"));var V=[],W=T.find("div.ref");W.each(function(){this_ref=$j(this),this_truncate=this_ref.find(".title").truncate({words:28}),this_date=this_ref.find("span.date").text(),this_date.length&&(this_date=this_date.replace(/-/g,""),4==this_date.length&&(this_date+="00"),6==this_date.length&&(this_date+="00"),this_date=parseFloat(this_date),this_ref.addClass("d_"+this_date),V.push(this_date));var a=this_ref.attr("id");this_footer=this_ref.find("div.footer"),this_context_id=this_footer.find("div.context:eq(0) div a").attr("href"),new_context_lnk='<a href="'+this_context_id+'">Show in Context</a><br />',this_abstract_el=this_ref.find("span.abstract"),new_abstract_lnk=$j(this_abstract_el.length?'<a href="#'+a+'" class="abstract_link"">Quick Abstract</a>':"<span>&nbsp;</span>"),this_footer.empty().append(new_context_lnk).append(new_abstract_lnk),this_ref.removeAttr("id")}),U.find("a.abstract_link").live("click",function(){$j("#references .content").show(),this_target=$j(this).attr("href"),f($j(this_target),"abstract")});var X=U.clone(),Y=X.find("div.ref");Y.eq(4).nextAll().remove(),V.sort(function(a,b){return b-a}),V=V.slice(0,5);var Z=$j('<div id="ref_wrap" />');$j.each(V,function(a,b){this_ref_clone=$j("#ref_wrap div.d_"+b).clone(),Z.append(this_ref_clone)}),Z.find("div.ref").eq(4).nextAll().remove(),U.replaceWith(X),$j("#ref_default").click(function(a){return a.stopPropagation(),$j(this).hasClass("current")||($j("#ref_wrap").replaceWith(X),$j(this).parent().find("a.current").removeClass("current")),$j(this).addClass("current"),!1}),$j("#ref_date").click(function(a){return a.stopPropagation(),$j(this).hasClass("current")||($j("#ref_wrap").replaceWith(Z),$j(this).parent().find("a.current").removeClass("current"),$j(this).addClass("current")),!1})}var $=$j("#cited-by");if($.find("div.no-content").length)b($,"cited-by",!0);else{b($,"cited-by"),c($,"cited-by");var _=s.find("div.glance-cited-by");_.find("h3").remove(),_.find("div.ref").eq(4).nextAll().remove(),d(_,"#"+$.attr("id")),_.find("div.ref").each(function(){this_cite=$j(this),this_truncate=this_cite.find(".title").truncate({words:25});var a=this_cite.attr("id");this_footer=this_cite.find("div.footer"),this_cite.find("div.body").append(this_cite.hasClass("ieee")?'<div class="source">Source: IEEE</div>':'<div class="source">Source: Other Publisher</div>'),this_footer.length?(new_abstract_lnk=$j('<a href="#'+a+'">Quick Abstract</a>').click(function(){$j("#cited-by .content").show(),target=$j("#"+a),f(target,"abstract")}),this_footer.empty().append(new_abstract_lnk)):this_cite.append('<div class="footer" />')}),e(_,"ref",5)}var ab=$j("#keywords");if(ab.find("div.no-content").length)b(ab,"keywords",!0);else{b(ab,"keywords"),c(ab,"keywords");var bb=s.find("div.glance-keywords"),cb=s.find("div.glance-keywords div.block");cb.first().addClass("first-item"),cb.each(function(){$j(this).truncate({words:32})}),d(bb,"#"+ab.attr("id")),e(bb,"block",4)}}var db=s.find("div.panel");t.find("li").click(function(){var a=$j(this);if(!a.hasClass("empty")){a.addClass("selected").siblings("li").removeClass("selected");var b=a.attr("id");db.hide().filter(function(){return $j(this).hasClass(b)}).show()}});var eb=z.find("div.data-hdr");eb.append('<div class="toggle-btn" />'),z.find("div.toggle-btn").click(function(){var a=$j(this),b=a.parent().siblings("div.content");b.is(":visible")?(a.addClass("toggle-close"),b.slideUp()):(a.removeClass("toggle-close"),b.slideDown())});var fb=$j("div.article-hdr","#Body"),gb=$j("div.toc","#Body");gb.wrapInner('<div class="body" />');var hb=gb.find("li"),ib=hb.length;if(ib>7){var jb=!0,kb=Math.ceil(ib/7);for(i=0,j=7,k=1;kb>=k;)hb.slice(i,j).wrapAll('<li class="page"><ul /></li>'),i+=7,j+=7,k++}$j(document).click(function(){$j(".jump-open").removeClass("jump-open")}),fb.each(function(){var a=$j(this),b=a.parent("div.section").attr("id"),c=gb.clone();$j('<div class="jump-btn" />').click(function(b){b.stopPropagation(),$j(".jump-open").not(a).removeClass("jump-open"),a.toggleClass("jump-open")}).prependTo(c);var d=c.find("div.body");if(d.click(function(b){b.stopPropagation(),$j(b.target).is("a")&&a.toggleClass("jump-open")}),c.find("a").each(function(){return this_lnk=$j(this),safe_lnk=this_lnk.attr("href").substring(this_lnk.attr("href").lastIndexOf("#")),safe_lnk=="#"+b?(jb&&this_lnk.parents("li.page").addClass("active"),this_txt=this_lnk.html(),this_lnk.parent().html(this_txt),!1):void 0}),jb){var e=d.find("li.page");$j('<div class="prev" />').click(function(){e.first().is(":hidden")&&e.filter(function(){return $j(this).is(":visible")}).hide().prev().show()}).prependTo(d),$j('<div class="next" />').click(function(){e.last().is(":hidden")&&e.filter(function(){return $j(this).is(":visible")}).hide().next().show()}).appendTo(d)}c.prependTo(a)});var lb=z.find("div.ref");lb.find("div.snippet").hide(),lb.find("span.abstract").each(function(){var a=$j(this),b=a.parents("div.ref").attr("id");a.click(function(){f($j("#"+b),"abstract")})}),lb.find("span.context").each(function(){var a=$j(this),b=a.parents("div.ref").attr("id");a.click(function(){f($j("#"+b),"context")})}),v.find("span.formula span.tex").hide(),v.find("span.formula span.html").hide();var mb=v.find("span.formula span.link");mb.click(function(){var a=$j(this);a.toggleClass("open_lnk"),a.siblings("span.tex").toggle()}),B.find("span.formula span.tex").hide(),B.find("span.formula span.html").hide();var mb=B.find("span.formula span.link");if(mb.click(function(){var a=$j(this);a.toggleClass("open_lnk"),a.siblings("span.tex").toggle()}),A.last().is(":hidden"))var nb=A.eq(A.length-2);else var nb=A.last();var ob=nb.innerHeight();g(),$j(window).resize(g);var pb=u.find("ul.in-page"),qb=pb.find("li"),rb=pb.find("a").filter(function(){return"#article"==$j(this).attr("href")}).parent("li");if(pb.length)var sb=!0;h(),$j(window).scroll(h),$j(window).resize(h),u.find("ul.in-page").click(function(a){if($j(a.target).is("a")){var b=a.target.href.substring(a.target.href.lastIndexOf("#")),c=$j(b),d=c.children("div.content");d.is(":hidden")&&(d.show(),c.find("div.toggle-btn").removeClass("toggle-close"))}});var tb=$j("div.column-main","#Body"),ub=$j("#text-sizer");ub.show();var vb=ub.find("span.link");vb.click(function(){$j(this).hasClass("selected")||(tb.toggleClass("larger"),vb.toggleClass("selected"))});var wb=$j("#Body .column-main").find('a[href^="#ref_"]');if(wb.length){$j("body").append('<div id="ref_popup" class="ref"></div>');var xb=$j("#ref_popup"),yb=$j("#article").offset().left+$j("#article").width(),zb=xb.width();wb.hover(function(){m(),o();var a=$j(this).offset().left+19;a+zb/2>yb&&(a-=zb+12,xb.addClass("flip")),$j(this).addClass("popup_active"),xb.show().css({top:$j(this).offset().top+"px",left:a+"px"}).html('<div class="header"></div>'+$j("#"+$j(this).attr("href").replace(/#/,"")).html());var b=xb.find("div.footer");b.find("span.link").remove(),b.find("div.snippet").remove(),b.html($j("#ref_popup .footer").html().replace("|","").replace(/Full Text: PDF \(.*\)/,"Full Text: PDF")),$j("#ref_popup .footer").prepend('<a href="#references">View All References</a>')},function(){n()}),xb.hover(function(){m(),$j(this).show()},function(){n()})}if($j(document).delegate("#print-page","click",function(a){return a.stopPropagation(),window.print(),!1}),window.sidebar||document.all||window.opera&&document.createElement){var Ab=window.location,Bb=document.title;$j(document).delegate("#bookmark-page","click",function(a){if(a.stopPropagation(),window.sidebar)window.sidebar.addPanel(Bb,Ab,"");else{if(!document.all)return!0;window.external.AddFavorite(Ab,Bb)}return!1})}else $j("li.tools-bookmark").remove();if($j("#email-article").click(function(){mail_str="mailto:?subject=Check out the "+document.title,mail_str+="&body=I thought you might be interested in the "+document.title,mail_str+=". You can view it at, "+location.href,location.href=mail_str}),C&&(p($j("div.pos_1","#at-glance"),"pos_1-hover"),p($j("div.pos_2","#at-glance"),"pos_2-hover"),p($j("div.pos_3","#at-glance"),"pos_3-hover")),$j(".closeVideo").live("click",function(){jwplayer("videoVideoCol").remove(),$j(".videoWrapper").remove()}),$j(".playVideo").live("click",function(a){a.preventDefault(),$j("#LayoutWrapper").prepend('<div class="videoWrapper"> <div id="videoVideoCol"></div> <div class="videoInfoCol"><span class="button closeVideo"><span>X CLOSE</span></span></div> </div>'),$j(a.target).parents("#media .video").clone().appendTo(".videoInfoCol");var b=$j(a.target).parents(".video").find(".body ul li a"),c=null;for(i=0;i<b.length;i++)null===c?c='{ file: "'+b[i]+'" }, ':c+='{ file: "'+b[i]+'" }, ';$j("#videoVideoCol").after('<script type="text/javascript"> jwplayer("videoVideoCol").setup({ flashplayer: "'+ASSETS_RELATIVE_PATH_NO_SERVER+'/icp/assets/swf/player.swf", height: 360, width: 660, autoplay: true, plugins: {},levels: ['+c+"] }); </script>")}),$j(".glance-abstract .media-group")){var Cb=$j(".glance-abstract .media-group .video-src"),Db=null;for(i=0;i<Cb.length;i++)null===Db?Db='{ file: "'+$j(Cb[i]).data("src")+'", image: "'+$j(Cb[i]).data("cimg")+'" }, ':Db+='{ file: "'+$j(Cb[i]).data("src")+'", image: "'+$j(Cb[i]).data("cimg")+'" }, ';$j(".glance-abstract .media").after('<script type="text/javascript"> jwplayer("video_player").setup({playlist: ['+Db+'],flashplayer: "'+ASSETS_RELATIVE_PATH_NO_SERVER+'/icp/assets/swf/player.swf", repeat: "list"}); </script>')}$j(window).resize(function(){$j(this).width()<1100?$j("#article-nav UL").addClass("small"):$j("#article-nav UL").removeClass("small")})}!function(a){a.fn.truncate=function(b){var c={words:30,terminal:"&hellip;"};b&&a.extend(c,b);var d=new RegExp("(<[A-z]+[1-6]?[^>]*/?>)|(</[A-z]+[1-6]? *>(?:[, !?:;'\"-])*)|( ?[^ <\n]+ ?)","g"),e=new RegExp("^<(img|[hb]r)"),f=new RegExp("[A-z]+[1-6]?");return this.each(function(){for(var b=a(this),g=0,h=0,j=[],k="";match=d.exec(b.html());)match[3]&&h++,g<c.words&&(k+=match[0],match[1]?e.test(match[1])||j.push(match[1].match(f)[0]):match[2]?j.pop():match[3]&&g++);if(j.length>0)for(i=j.length-1;i>=0;i--)k+="</"+j[i]+">";return h<=c.words?b:b.html(k).append(c.terminal)})}}(jQuery);var $j=jQuery.noConflict();$j(document).ready(function(){populateRightsLink(),populateCitationReferences(),populateFunction(),$j.getJSON(document.getElementById("recommendUrl").value,populateRelatedArticles)});